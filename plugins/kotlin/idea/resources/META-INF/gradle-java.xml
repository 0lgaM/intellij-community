<idea-plugin xmlns:xi="http://www.w3.org/2001/XInclude">
  <xi:include href="parcelize-dep-gradle.xml" xpointer="xpointer(/idea-plugin/*)"/>
  <xi:include href="scripting-dep-gradle.xml" xpointer="xpointer(/idea-plugin/*)"/>
  <xi:include href="allopen-dep-gradle.xml" xpointer="xpointer(/idea-plugin/*)"/>
  <xi:include href="noarg-dep-gradle.xml" xpointer="xpointer(/idea-plugin/*)"/>
  <xi:include href="sam-with-receiver-dep-gradle.xml" xpointer="xpointer(/idea-plugin/*)"/>
  <xi:include href="kapt-dep-gradle.xml" xpointer="xpointer(/idea-plugin/*)"/>
  <xi:include href="kotlinx-serialization-dep-gradle.xml" xpointer="xpointer(/idea-plugin/*)"/>

  <extensions defaultExtensionNs="org.jetbrains.plugins.gradle">
    <testTasksProvider implementation="org.jetbrains.kotlin.idea.gradle.run.KotlinMPPGradleTestTasksProvider"/>

    <frameworkSupport implementation="org.jetbrains.kotlin.idea.gradle.configuration.GradleKotlinMPPSourceSetsFrameworkSupportProvider"/>
    <frameworkSupport implementation="org.jetbrains.kotlin.idea.gradle.configuration.GradleKotlinJavaFrameworkSupportProvider"/>
    <frameworkSupport implementation="org.jetbrains.kotlin.idea.gradle.configuration.GradleKotlinJSBrowserFrameworkSupportProvider"/>
    <frameworkSupport implementation="org.jetbrains.kotlin.idea.gradle.configuration.GradleKotlinJSNodeFrameworkSupportProvider"/>

    <kotlinDslFrameworkSupport implementation="org.jetbrains.kotlin.idea.gradle.configuration.KotlinDslGradleKotlinMPPFrameworkSupportProvider"/>
    <kotlinDslFrameworkSupport implementation="org.jetbrains.kotlin.idea.gradle.configuration.KotlinDslGradleKotlinJavaFrameworkSupportProvider"/>
    <kotlinDslFrameworkSupport implementation="org.jetbrains.kotlin.idea.gradle.configuration.KotlinDslGradleKotlinJSBrowserFrameworkSupportProvider"/>
    <kotlinDslFrameworkSupport implementation="org.jetbrains.kotlin.idea.gradle.configuration.KotlinDslGradleKotlinJSNodeFrameworkSupportProvider"/>

    <pluginDescriptions implementation="org.jetbrains.kotlin.idea.gradle.configuration.KotlinGradlePluginDescription"/>

    <projectResolve implementation="org.jetbrains.kotlin.idea.gradle.scripting.importing.KotlinDslScriptModelResolver" order="first"/>
    <projectResolve implementation="org.jetbrains.kotlin.idea.gradle.commonizer.KotlinCommonizerModelResolver" order="first"/>
    <projectResolve implementation="org.jetbrains.kotlin.idea.gradle.cocoapods.KotlinCocoaPodsModelResolver" order="last"/>
    <projectResolve implementation="org.jetbrains.kotlin.idea.gradle.configuration.KotlinGradleProjectResolverExtension" order="first"/>
    <projectResolve implementation="org.jetbrains.kotlin.idea.gradle.configuration.KotlinGradleCoroutineDebugProjectResolver" order="last"/>
    <projectResolve implementation="org.jetbrains.kotlin.idea.gradle.testing.KotlinTestTasksResolver"/>
  </extensions>

  <extensions defaultExtensionNs="com.intellij">
    <postStartupActivity implementation="org.jetbrains.kotlin.idea.gradle.scripting.SdkValidator"/>

    <externalProjectDataService implementation="org.jetbrains.kotlin.idea.gradle.configuration.KotlinGradleSourceSetDataService"/>
    <externalProjectDataService implementation="org.jetbrains.kotlin.idea.gradle.configuration.KotlinGradleProjectDataService"/>
    <externalProjectDataService implementation="org.jetbrains.kotlin.idea.gradle.configuration.KotlinGradleLibraryDataService"/>
    <externalProjectDataService implementation="org.jetbrains.kotlin.idea.gradle.configuration.KotlinTargetDataService"/>
    <externalProjectDataService implementation="org.jetbrains.kotlin.idea.gradle.configuration.KotlinOutputPathsDataService"/>
    <externalProjectDataService implementation="org.jetbrains.kotlin.idea.gradle.KotlinJavaMPPSourceSetDataService"/>
    <externalProjectDataService implementation="org.jetbrains.kotlin.idea.gradle.configuration.klib.KotlinNativeLibraryDataService"/>

    <externalSystemTaskNotificationListener implementation="org.jetbrains.kotlin.idea.gradle.scripting.importing.KotlinDslSyncListener"/>

    <editorNotificationProvider implementation="org.jetbrains.kotlin.idea.gradle.scripting.GradleScriptNotificationProvider"/>

    <runConfigurationProducer implementation="org.jetbrains.kotlin.idea.gradle.run.KotlinJvmTestClassGradleConfigurationProducer"/>
    <runConfigurationProducer implementation="org.jetbrains.kotlin.idea.gradle.run.KotlinMultiplatformJvmTestClassGradleConfigurationProducer"/>
    <runConfigurationProducer implementation="org.jetbrains.kotlin.idea.gradle.run.KotlinJvmTestMethodGradleConfigurationProducer"/>
    <runConfigurationProducer implementation="org.jetbrains.kotlin.idea.gradle.run.KotlinMultiplatformJvmTestMethodGradleConfigurationProducer"/>
    <runConfigurationProducer implementation="org.jetbrains.kotlin.idea.gradle.testing.js.KotlinMultiplatformJsTestClassGradleConfigurationProducer"/>
    <runConfigurationProducer implementation="org.jetbrains.kotlin.idea.gradle.testing.js.KotlinMultiplatformJsTestMethodGradleConfigurationProducer"/>
    <runConfigurationProducer implementation="org.jetbrains.kotlin.idea.gradle.testing.native.KotlinMultiplatformNativeTestClassGradleConfigurationProducer"/>
    <runConfigurationProducer implementation="org.jetbrains.kotlin.idea.gradle.testing.native.KotlinMultiplatformNativeTestMethodGradleConfigurationProducer"/>
    <runConfigurationProducer implementation="org.jetbrains.kotlin.idea.gradle.testing.common.KotlinMultiplatformCommonTestClassGradleConfigurationProducer"/>
    <runConfigurationProducer implementation="org.jetbrains.kotlin.idea.gradle.testing.common.KotlinMultiplatformCommonTestMethodGradleConfigurationProducer"/>

    <registryKey
            key="kotlin.gradle.testing.enabled"
            description="Import Kotlin Gradle test tasks and process test output"
            defaultValue="true"
            restartRequired="false"/>
    <registryKey
            key="kotlin.mpp.tests.force.gradle"
            description="Run multi-platform tests with Gradle runner even if the platform runner is used by default.
              This setting currently affects only HMPP projects. You may need to delete existing test configurations for the change to take place."
            defaultValue="true"
            restartRequired="false"/>
  </extensions>

  <extensions defaultExtensionNs="org.jetbrains.kotlin">
    <projectConfigurator implementation="org.jetbrains.kotlin.idea.gradle.configuration.KotlinGradleModuleConfigurator"/>
    <projectConfigurator implementation="org.jetbrains.kotlin.idea.gradle.configuration.KotlinJsGradleModuleConfigurator"/>

    <gradleModelFacade implementation="org.jetbrains.kotlin.idea.gradle.inspections.DefaultGradleModelFacade"/>

    <scriptDefinitionContributor implementation="org.jetbrains.kotlin.idea.gradle.scripting.GradleScriptDefinitionsContributor" order="first"/>

    <scriptAdditionalIdeaDependenciesProvider implementation="org.jetbrains.kotlin.idea.gradle.scripting.GradleScriptAdditionalIdeaDependenciesProvider"/>
  </extensions>
</idea-plugin>
