<idea-plugin>
  <extensions defaultExtensionNs="com.intellij">
    <projectService serviceInterface="org.jetbrains.kotlin.analysis.providers.KotlinDeclarationProviderFactory"
                    serviceImplementation="org.jetbrains.kotlin.idea.base.analysisApiProviders.IdeKotlinDeclarationProviderFactory"/>

    <projectService serviceInterface="org.jetbrains.kotlin.analysis.providers.KotlinAnnotationsResolverFactory"
                    serviceImplementation="org.jetbrains.kotlin.idea.base.analysisApiProviders.IdeKotlinAnnotationsResolverFactory"/>

    <projectService serviceInterface="org.jetbrains.kotlin.analysis.providers.KotlinPackageProviderFactory"
                    serviceImplementation="org.jetbrains.kotlin.idea.base.analysisApiProviders.IdeKotlinPackageProviderFactory"/>

    <projectService serviceInterface="org.jetbrains.kotlin.analysis.providers.KotlinModificationTrackerFactory"
                    serviceImplementation="org.jetbrains.kotlin.idea.base.fir.analysisApiProviders.FirIdeKotlinModificationTrackerFactory"/>

    <projectService serviceImplementation="org.jetbrains.kotlin.idea.base.fir.analysisApiProviders.FirIdeModificationTrackerService"/>

    <psi.treeChangePreprocessor
            implementation="org.jetbrains.kotlin.idea.base.fir.analysisApiProviders.FirIdeOutOfBlockPsiTreeChangePreprocessor"/>

  </extensions>
</idea-plugin>