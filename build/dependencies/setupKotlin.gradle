// Copyright 2000-2018 JetBrains s.r.o. Use of this source code is governed by the Apache 2.0 license that can be found in the LICENSE file.
repositories {
  if (project.ext.inJetBrainsNetwork) {
    maven { url 'http://repo.labs.intellij.net/plugins.jetbrains.com' }
  }
  maven { url 'http://plugins.jetbrains.com/maven/' }
  teamcityServer { url = 'https://teamcity.jetbrains.com' }
}

configurations {
  kotlinPlugin
  kotlinPluginCidr
}

dependencies {
  kotlinPlugin "com.jetbrains.plugins:org.jetbrains.kotlin:$kotlinPluginBuild@zip"
  kotlinPluginCidr tc(buildTypeId: 'Kotlin_1250_CompilerAllPlugins', version: "${kotlinPluginBuildForKotlinNative.split('-')[0..2].join('-')}", artifactPath: "internal/kotlin-plugin-${kotlinPluginBuildForKotlinNative}.zip")
}

task setupKotlinPluginCidr(dependsOn: configurations.kotlinPluginCidr, type: Sync) {
  from zipTree(configurations.kotlinPluginCidr.singleFile)
  into "${project.buildDir}/kotlinCidr"
}

task setupKotlinPlugin(dependsOn: [configurations.kotlinPlugin, setupKotlinPluginCidr], type: Sync) {
  from zipTree(configurations.kotlinPlugin.singleFile)
  into "${project.buildDir}/kotlin"
}